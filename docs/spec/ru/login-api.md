# Спецификация API входа

- [A-1. Получение URL-адреса ЕСИА для входа через OAuth2](#a-1-%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-url-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0-%D0%B5%D1%81%D0%B8%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%B2%D1%85%D0%BE%D0%B4%D0%B0-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-oauth2)
- [A-2. Вход через ЕСИА](#a-2-%D0%B2%D1%85%D0%BE%D0%B4-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-%D0%B5%D1%81%D0%B8%D0%B0)
- [A-3. Вход через личный кабинет налогоплательщика](#a-3-%D0%B2%D1%85%D0%BE%D0%B4-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-%D0%BB%D0%B8%D1%87%D0%BD%D1%8B%D0%B9-%D0%BA%D0%B0%D0%B1%D0%B8%D0%BD%D0%B5%D1%82-%D0%BD%D0%B0%D0%BB%D0%BE%D0%B3%D0%BE%D0%BF%D0%BB%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D1%89%D0%B8%D0%BA%D0%B0)
- [A-4. Отправка запроса для входа по номеру телефона](#a-4-%D0%BE%D1%82%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B0-%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%B2%D1%85%D0%BE%D0%B4%D0%B0-%D0%BF%D0%BE-%D0%BD%D0%BE%D0%BC%D0%B5%D1%80%D1%83-%D1%82%D0%B5%D0%BB%D0%B5%D1%84%D0%BE%D0%BD%D0%B0)
- [A-5. Вход по номеру телефона](#a-5-%D0%B2%D1%85%D0%BE%D0%B4-%D0%BF%D0%BE-%D0%BD%D0%BE%D0%BC%D0%B5%D1%80%D1%83-%D1%82%D0%B5%D0%BB%D0%B5%D1%84%D0%BE%D0%BD%D0%B0)
- [A-6. Повторный вход с помощью токена обновления](#a-6-%D0%BF%D0%BE%D0%B2%D1%82%D0%BE%D1%80%D0%BD%D1%8B%D0%B9-%D0%B2%D1%85%D0%BE%D0%B4-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%B0-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F)

## **A-1. Получение URL-адреса ЕСИА для входа через OAuth2**

`GET v2/mobile/users/esia/auth/url`

Авторизация не требуется.

#### **Параметры запроса**

**Нет**

#### Успешный ответ (Код: `200 OK`)

| Req | Название        | Тип                                                | Описание                                           |
| --- | --------------- | -------------------------------------------------- | -------------------------------------------------- |
| \*  | EsiaUrlResponse | [EsiaUrlResponse](./data-model.md#EsiaUrlResponse) | Данные, содержащие URL-адрес для входа через ЕСИА. |

#### **Ошибки**

| Код                        | Тип    | Описание                          |
| --------------------------- | ------ | --------------------------------- |
| **500 Server Error**        | string | Сервер не смог обработать запрос. |
| **503 Service Unavailable** | string | Сервис временно недоступен.       |

## **A-2. Вход через ЕСИА**

`POST v2/mobile/users/esia/auth`

Авторизация не требуется.

#### **Параметры запроса**

| Req | Название         | Принадлежность | Тип                                                  | Описание        |
| --- | ---------------- | -------------- | ---------------------------------------------------- | --------------- |
| \*  | EsiaLoginRequest | Body           | [EsiaLoginRequest](./data-model.md#EsiaLoginRequest) | Данные запроса. |

#### Успешный ответ (Код: `200 OK`)

| Req | Название      | Тип                                            | Описание                     |
| --- | ------------- | ---------------------------------------------- | ---------------------------- |
| \*  | LoginResponse | [LoginResponse](./data-model.md#LoginResponse) | Информация о токене доступа. |

#### **Ошибки**

| Код                        | Тип    | Описание                          |
| --------------------------- | ------ | --------------------------------- |
| **400 Bad Request**         | string | Неверные параметры запроса.       |
| **500 Server Error**        | string | Сервер не смог обработать запрос. |
| **503 Service Unavailable** | string | Сервис временно недоступен.       |

## **A-3. Вход через личный кабинет налогоплательщика**

`POST v2/mobile/users/lkfl/auth`

Авторизация не требуется.

#### **Параметры запроса**

| Req | Название         | Принадлежность | Тип                                                  | Описание        |
| --- | ---------------- | -------------- | ---------------------------------------------------- | --------------- |
| \*  | LKFLLoginRequest | Body           | [LKFLLoginRequest](./data-model.md#LKFLLoginRequest) | Данные запроса. |

#### Успешный ответ (Код: `200 OK`)

| Req | Название      | Тип                                            | Описание                     |
| --- | ------------- | ---------------------------------------------- | ---------------------------- |
| \*  | LoginResponse | [LoginResponse](./data-model.md#LoginResponse) | Информация о токене доступа. |

#### **Ошибки**

| Код                        | Тип    | Описание                          |
| --------------------------- | ------ | --------------------------------- |
| **400 Bad Request**         | string | Неверные параметры запроса.       |
| **500 Server Error**        | string | Сервер не смог обработать запрос. |
| **503 Service Unavailable** | string | Сервис временно недоступен.       |

## **A-4. Отправка запроса для входа по номеру телефона**

`POST v2/auth/phone/request`

Авторизация не требуется.

#### **Параметры запроса**

| Req | Название          | Принадлежность | Тип                                                    | Описание        |
| --- | ----------------- | -------------- | ------------------------------------------------------ | --------------- |
| \*  | PhoneLoginRequest | Body           | [PhoneLoginRequest](./data-model.md#PhoneLoginRequest) | Данные запроса. |

#### Успешный ответ (Код: `200 OK`)

На указанный номер телефона отправлено SMS с кодом подтверждения.

#### **Ошибки**

| Код                        | Тип    | Описание                          |
| --------------------------- | ------ | --------------------------------- |
| **400 Bad Request**         | string | Неверные параметры запроса.       |
| **500 Server Error**        | string | Сервер не смог обработать запрос. |
| **503 Service Unavailable** | string | Сервис временно недоступен.       |

## **A-5. Вход по номеру телефона**

`POST v2/auth/phone/verify`

Авторизация не требуется.

#### **Параметры запроса**

| Req | Название           | Принадлежность | Тип                                                      | Описание        |
| --- | ------------------ | -------------- | -------------------------------------------------------- | --------------- |
| \*  | PhoneVerifyRequest | Body           | [PhoneVerifyRequest](./data-model.md#PhoneVerifyRequest) | Данные запроса. |

#### Успешный ответ (Код: `200 OK`)

| Req | Название      | Тип                                            | Описание                     |
| --- | ------------- | ---------------------------------------------- | ---------------------------- |
| \*  | LoginResponse | [LoginResponse](./data-model.md#LoginResponse) | Информация о токене доступа. |

#### **Ошибки**

| Код                        | Тип    | Описание                          |
| --------------------------- | ------ | --------------------------------- |
| **400 Bad Request**         | string | Неверные параметры запроса.       |
| **500 Server Error**        | string | Сервер не смог обработать запрос. |
| **503 Service Unavailable** | string | Сервис временно недоступен.       |

## **A-6. Повторный вход с помощью токена обновления**

`POST v2/mobile/users/refresh`

Авторизация не требуется.

#### **Параметры запроса**

| Req | Название             | Принадлежность | Тип                                                          | Описание        |
| --- | -------------------- | -------------- | ------------------------------------------------------------ | --------------- |
| \*  | RefreshTokensRequest | Body           | [RefreshTokensRequest](./data-model.md#RefreshTokensRequest) | Данные запроса. |

#### Успешный ответ (Код: `200 OK`)

| Req | Название              | Тип                                                            | Описание                                |
| --- | --------------------- | -------------------------------------------------------------- | --------------------------------------- |
| \*  | RefreshTokensResponse | [RefreshTokensResponse](./data-model.md#RefreshTokensResponse) | Данные ответа, содержащие новые токены. |

#### **Ошибки**

| Код                        | Тип    | Описание                          |
| --------------------------- | ------ | --------------------------------- |
| **400 Bad Request**         | string | Неверные параметры запроса.       |
| **500 Server Error**        | string | Сервер не смог обработать запрос. |
| **503 Service Unavailable** | string | Сервис временно недоступен.       |
