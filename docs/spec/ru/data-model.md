# Модель данных

## EsiaUrlResponse

| Req | Имя | Тип    | Описание                                                                       |
| --- | --- | ------ | ------------------------------------------------------------------------------ |
| \*  | url | string | URL-адрес для входа через внешнего провайдера ЕСИА, который использует OAuth2. |

## EsiaLoginRequest

| Req | Имя                | Тип    | Описание                                                                                              |
| --- | ------------------ | ------ | ----------------------------------------------------------------------------------------------------- |
| \*  | authorization_code | string | Код авторизации — это временный код, который клиент обменяет на токен доступа. Используется в OAuth2. |
| \*  | state              | string | Параметр состояния используется для защиты от XSRF в потоке OAuth2.                                   |
| \*  | client_secret      | string | [Секрет клиента](./terms.md#%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D1%8B)                               |

## LKFLLoginRequest

| Req | Имя           | Тип    | Описание                                                                |
| --- | ------------- | ------ | ----------------------------------------------------------------------- |
| \*  | inn           | string | Идентификационный налоговый номер. Используется при входе через ФНС ЛК. |
| \*  | password      | string | Пароль от ФНС ЛК.                                                       |
| \*  | client_secret | string | [Секрет клиента](./terms.md#%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D1%8B) |

## PhoneLoginRequest

| Req | Имя           | Тип    | Описание                                                                |
| --- | ------------- | ------ | ----------------------------------------------------------------------- |
| \*  | phone         | string | Ваш номер телефона.                                                     |
| \*  | captcha       | string | Значение от Google капча.                                               |
| \*  | os            | string | Значение: `android` или `ios`.                                          |
| \*  | client_secret | string | [Секрет клиента](./terms.md#%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D1%8B) |

## PhoneVerifyRequest

| Req | Имя           | Тип    | Описание                                                                |
| --- | ------------- | ------ | ----------------------------------------------------------------------- |
| \*  | phone         | string | Ваш номер телефона.                                                     |
| \*  | code          | string | Код подтверждения, отправленный вам по СМС.                             |
| \*  | client_secret | string | [Секрет клиента](./terms.md#%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D1%8B) |

## LoginResponse

| Req    | Имя           | Тип    | Описание                                                                                                                                                                                                                            |
| ------ | ------------- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| &nbsp; | email         | string | Адрес электронной почты, указанный при регистрации (необязательно).                                                                                                                                                                 |
| &nbsp; | name          | string | Ваше имя, указанное при регистрации (необязательно).                                                                                                                                                                                |
| &nbsp; | phone         | string | Ваш номер телефона (необязательно).                                                                                                                                                                                                 |
| &nbsp; | region        | string | Ваш регион (необязательно).                                                                                                                                                                                                         |
| &nbsp; | surname       | string | Ваша фамилия (необязательно).                                                                                                                                                                                                       |
| \*     | sessionId     | string | [Токен доступа](./terms.md#%D1%82%D0%BE%D0%BA%D0%B5%D0%BD-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0). Используется при [авторизации](./general-spec.md#%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82-%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D0%B0). |
| \*     | refresh_token | string | [Токен обновления](./terms.md#%D1%82%D0%BE%D0%BA%D0%B5%D0%BD-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F)                                                                                                          |

## RefreshTokensRequest

| Req | Имя           | Тип    | Описание                                                                                                                   |
| --- | ------------- | ------ | -------------------------------------------------------------------------------------------------------------------------- |
| \*  | refresh_token | string | [Токен обновления](./terms.md#%D1%82%D0%BE%D0%BA%D0%B5%D0%BD-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F) |
| \*  | client_secret | string | [Секрет клиента](./terms.md#%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D1%8B)                                                    |

## RefreshTokensResponse

| Req | Имя           | Тип    | Описание                                                                                                                                                                                                                            |
| --- | ------------- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| \*  | sessionId     | string | [Токен доступа](./terms.md#%D1%82%D0%BE%D0%BA%D0%B5%D0%BD-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0). Используется при [авторизации](./general-spec.md#%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82-%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D0%B0). |
| \*  | refresh_token | string | [Токен обновления](./terms.md#%D1%82%D0%BE%D0%BA%D0%B5%D0%BD-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F)                                                                                                          |

## AddReceiptRequest

| Req | Имя         | Тип                       | Описание                                                        |
| --- | ----------- | ------------------------- | --------------------------------------------------------------- |
| \*  | fiscalData  | [FiscalData](#fiscaldata) | Фискальные данные чека.                                         |
| \*  | sendToEmail | boolean                   | Укажите `true`, если хотите отправить чек по электронной почте. |

## AddReceiptQRRequest

| Req | Имя | Тип    | Описание                                                                                     |
| --- | --- | ------ | -------------------------------------------------------------------------------------------- |
| \*  | qr  | string | Строка, которая содержит данные из QR-кода на чеке. Подробнее [здесь](./receipt-qr-code.md). |

## ReceiptShort

| Req    | Имя          | Тип                           | Описание                                                                                     |
| ------ | ------------ | ----------------------------- | -------------------------------------------------------------------------------------------- |
| \*     | id           | string                        | Уникальный идентификатор чека.                                                               |
| \*     | status       | int                           | Статус обработки запроса на получение чека. См. [ReceiptStatus](#receiptstatus).             |
| \*     | kind         | string                        | Доступные значения: `kkt` or `npd`. См. [ReceiptKind](#receiptkind).                         |
| &nbsp; | createdAt    | string                        | Время создания запроса в формате ISO 8601. Например. `2022-02-22T16:59:35+03:00`.            |
| &nbsp; | qr           | string                        | Строка, которая содержит данные из QR-кода на чеке. Подробнее [здесь](./receipt-qr-code.md). |
| &nbsp; | operation    | [Operation](#operation)       | Информация о транзакции.                                                                     |
| &nbsp; | query        | [ReceiptQuery](#receiptquery) | Фискальные данные чека.                                                                      |
| &nbsp; | organization | [Organization](#organization) | Информация об организации, если чек был получен (необязательно).                             |
| &nbsp; | seller       | [Seller](#seller)             | Информация о продавце, если чек был получен (необязательно).                                 |

## ReceiptDetails

| Req    | Имя          | Тип                           | Описание                                                                                     |
| ------ | ------------ | ----------------------------- | -------------------------------------------------------------------------------------------- |
| \*     | id           | string                        | Уникальный идентификатор чека.                                                               |
| \*     | status       | int                           | Статус обработки запроса на получение чека. См. [ReceiptStatus](#receiptstatus).             |
| \*     | kind         | string                        | Доступные значения: `kkt` or `npd`. См. [ReceiptKind](#receiptkind).                         |
| \*     | createdAt    | string                        | Время создания запроса в формате ISO 8601. Например. `2022-02-22T16:59:35+03:00`.            |
| \*     | qr           | string                        | Строка, которая содержит данные из QR-кода на чеке. Подробнее [здесь](./receipt-qr-code.md). |
| \*     | operation    | [Operation](#operation)       | Информация о транзакции.                                                                     |
| \*     | query        | [ReceiptQuery](#receiptquery) | Фискальные данные чека.                                                                      |
| &nbsp; | ticket       | [Document](#document)         | Информация о чеке, если чек был получен (необязательно).                                     |
| &nbsp; | organization | [Organization](#organization) | Информация об организации, если чек был получен (необязательно).                             |
| &nbsp; | seller       | [Seller](#seller)             | Информация о продавце, если чек был получен (необязательно).                                 |

## Document

| Req | Имя      | Тип                                 | Описание                  |
| --- | -------- | ----------------------------------- | ------------------------- |
| \*  | document | [ReceiptDocument](#receiptdocument) | Документ, содержащий чек. |

## ReceiptDocument

| Req | Имя     | Тип                 | Описание        |
| --- | ------- | ------------------- | --------------- |
| \*  | receipt | [Receipt](#receipt) | Данные по чеку. |

## Operation

| Req | Имя  | Тип    | Описание                                                                                                                               |
| --- | ---- | ------ | -------------------------------------------------------------------------------------------------------------------------------------- |
| \*  | date | string | Дата с чека. Формат даты: `yyyy-MM-dd'T'HH:mm:ss`, секунды указывать необязательно, их можно обнулить. Например `2018-05-17T17:57:00`. |
| \*  | type | int    | Тип операции (продажа, покупка и тд.). См. [OperationType](#operationtype).                                                      |
| \*  | sum  | long   | Общая сумма по чеку, в копейках.                                                                                                       |

## Organization

| Req | Имя  | Тип    | Описание              |
| --- | ---- | ------ | --------------------- |
| \*  | name | string | Название организации. |
| \*  | inn  | string | ИНН организации.      |

## Seller

| Req | Имя  | Тип    | Описание              |
| --- | ---- | ------ | --------------------- |
| \*  | name | string | Название организации. |
| \*  | inn  | string | ИНН организации.      |

## ReceiptStatus

| Имя                       | Тип          | Value      | Описание |
| ------------------------- | ------------ | ---------- | -------- |
| NPD_FOUND                 | Array\<int\> | [20]       |          |
| NPD_NOT_FOUND             | Array\<int\> | [422]      |          |
| COPY_REQUESTED            | Array\<int\> | [3,11]     |          |
| ERROR                     | Array\<int\> | [4]        |          |
| HAVE_COPY                 | Array\<int\> | [2]        |          |
| HSM_NOK                   | Array\<int\> | [8,10]     |          |
| HSM_REQUESTED             | Array\<int\> | [0,7,9]    |          |
| STANDALONE_CASH           | Array\<int\> | [12,13,15] |          |
| RETRIEVE_FAILED           | Array\<int\> | [5]        |          |
| UNSUPPORTED_DOCUMENT_TYPE | Array\<int\> | [16]       |          |

## OperationType

| Имя            | Тип | Value | Описание                   |
| -------------- | --- | ----- | -------------------------- |
| UNKNOWN        | int | 0     | Неизвестный                |
| INCOME         | int | 1     | Покупка товаров или услуг. |
| INCOME_RETURN  | int | 2     | Возврат товаров или услуг. |
| EXPENSE        | int | 3     | Расход                     |
| EXPENSE_RETURN | int | 4     | Расходы на возврат.        |

## ReceiptKind

| Имя | Тип    | Value | Описание |
| --- | ------ | ----- | -------- |
| KKT | string | "kkt" |          |
| NPD | string | "npd" |          |

## TaxationType

| Имя     | Тип | Value | Описание |
| ------- | --- | ----- | -------- |
| UNKNOWN | int | 0     |          |
| OSN     | int | 1     |          |
| ISN     | int | 2     |          |
| EXT_USN | int | 3     |          |
| ENVD    | int | 8     |          |
| ESHN    | int | 16    |          |
| PSN     | int | 32    |          |

## ReceiptQuery

Псевдоним для [FiscalData](#fiscaldata).

## FiscalData

| Req | Имя           | Тип    | Описание                                                                                                                               |
| --- | ------------- | ------ | -------------------------------------------------------------------------------------------------------------------------------------- |
| \*  | date          | string | Дата с чека. Формат даты: `yyyy-MM-dd'T'HH:mm:ss`, секунды указывать необязательно, их можно обнулить. Например `2018-05-17T17:57:00`. |
| \*  | operationType | int    | Тип операции (продажа, покупка и тд.). См. [OperationType](#operationtype).                                                      |
| \*  | sum           | long   | Общая сумма по чеку, в копейках.                                                                                                       |
| \*  | fsId          | string | Номер ФН (Фискальный Номер) 16-значный. Например `8710000100518392`.                                                                   |
| \*  | documentId    | long   | Номер ФД (Фискальный Документ) до 10 знаков. Например `54812`.                                                                         |
| \*  | fiscalSign    | string | Номер ФПД (Фискальный Признак Документа, также известный как ФП) до 10 знаков. Например `3522207165`.                                  |

## Receipt

| Req    | Имя                     | Тип                                  | Описание                                                                                              |
| ------ | ----------------------- | ------------------------------------ | ----------------------------------------------------------------------------------------------------- |
| \*     | dateTime                | long                                 | Дата покупки в timestamp. Например. `1551000840`.                                                     |
| \*     | totalSum                | long                                 | Общая сумма по чеку, в копейках.                                                                      |
| \*     | cashTotalSum            | long                                 | Сумма, оплаченная наличными, в копейках.                                                              |
| \*     | ecashTotalSum           | long                                 | Сумма, оплаченная безналичным способом оплаты, в копейках.                                            |
| &nbsp; | creditSum               | long                                 | Сумма кредита, в копейках.                                                                            |
| &nbsp; | prepaidSum              | long                                 | Сумма предоплаты, в копейках.                                                                         |
| &nbsp; | provisionSum            | long                                 | Сумма резерва, в копейках.                                                                            |
| &nbsp; | ndsNo                   | long                                 | Сумма без учета НДС.                                                                                  |
| &nbsp; | nds10                   | int                                  | Сумма НДС, оплаченная по ставке 10%, в копейках.                                                      |
| &nbsp; | nds18                   | int                                  | Сумма НДС, оплаченная по ставке 18%, в копейках.                                                      |
| &nbsp; | nds20                   | int                                  | Сумма НДС, оплаченная по ставке 20%, в копейках.                                                      |
| \*     | fiscalDriveNumber       | string                               | Номер ФН (Фискальный Номер) 16-значный. Например `8710000100518392`.                                  |
| &nbsp; | fiscalDocumentFormatVer | int                                  | Версия формата номера фискального документа.                                                          |
| \*     | fiscalDocumentNumber    | long                                 | Номер ФД (Фискальный Документ) до 10 знаков. Например `54812`.                                        |
| \*     | fiscalSign              | long                                 | Номер ФПД (Фискальный Признак Документа, также известный как ФП) до 10 знаков. Например `3522207165`. |
| &nbsp; | fnsUrl                  | string                               | Значение: `nalog.ru`                                                                                  |
| &nbsp; | internetSign            | int                                  |                                                                                                       |
| \*     | items                   | Array\<[ReceiptItem](#receiptitem)\> | Товары / услуги, участвующие в операции.                                                              |
| \*     | kktRegId                | string                               | Регистрационный номер ККТ.                                                                            |
| &nbsp; | machineNumber           | string                               |                                                                                                       |
| &nbsp; | messageFiscalSign       | long                                 |                                                                                                       |
| \*     | operationType           | int                                  | Тип операции (продажа, покупка и тд.). См. [OperationType](#operationtype).                     |
| \*     | operator                | string                               | Данные кассира, который пробил чек.                                                                   |
| &nbsp; | operatorInn             | string                               | ИНН кассира, который пробил чек.                                                                      |
| &nbsp; | paymentAgentType        | int                                  |                                                                                                       |
| &nbsp; | propertiesData          | string                               | Пользовательские данные.                                                                              |
| &nbsp; | propertiesUser          | [UserProperty](#userproperty)        | Пользовательские данные.                                                                              |
| &nbsp; | receiptCode             | int                                  | Код чека.                                                                                             |
| \*     | requestNumber           | int                                  | Номер запроса.                                                                                        |
| \*     | shiftNumber             | int                                  | Номер смены.                                                                                          |
| \*     | taxationType            | int                                  | Тип системы налогообложения. См. [TaxationType](#taxationtype).                                 |
| \*     | user                    | string                               | Наименование продавца.                                                                                |
| \*     | userInn                 | string                               | ИНН продавца.                                                                                         |
| &nbsp; | retailPlaceAddress      | string                               | Адрес точки продажи.                                                                                  |
| &nbsp; | retailPlace             | string                               | Информация о торговом месте.                                                                          |
| &nbsp; | sellerAddress           | string                               | Адрес электронной почты продавца.                                                                     |
| &nbsp; | buyerAddress            | string                               | Информация о покупателе.                                                                              |
| &nbsp; | senderAddress           | string                               | Адрес электронной почты организации, отправившей информацию по чеку в ФНС.                            |

## ReceiptItem

| Req    | Имя         | Тип    | Описание                                         |
| ------ | ----------- | ------ | ------------------------------------------------ |
| \*     | name        | string | Наименование позиции.                            |
| \*     | quantity    | double | Количество.                                      |
| \*     | price       | long   | Цена позиции, в копейках.                        |
| \*     | sum         | long   | Сумма по позиции, в копейках.                    |
| &nbsp; | nds         | int    |                                                  |
| &nbsp; | ndsNo       | long   | Сумма без учета НДС.                             |
| &nbsp; | nds10       | int    | Сумма НДС, оплаченная по ставке 10%, в копейках. |
| &nbsp; | nds18       | int    | Сумма НДС, оплаченная по ставке 18%, в копейках. |
| &nbsp; | nds20       | int    | Сумма НДС, оплаченная по ставке 20%, в копейках. |
| &nbsp; | paymentType | int    | Тип платежа.                                     |
| &nbsp; | providerInn | string | ИНН фискальной организации.                      |
| &nbsp; | productType | int    | Тип продукта.                                    |

## UserProperty

| Req | Имя           | Тип    | Описание                            |
| --- | ------------- | ------ | ----------------------------------- |
| \*  | propertyName  | string | Пользовательское название свойства. |
| \*  | propertyValue | string | Пользовательское значение свойства. |
